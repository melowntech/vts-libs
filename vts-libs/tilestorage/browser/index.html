<html>
<head>
<title>Vadstena Map Viewer</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<script type="text/javascript">var f,t={};window.Vadstena=t;window.ga={};t.ta=Array;t.$c={};t.$c.create=function(a){var b=new t.ta(2);a&&(b[0]=a[0],b[1]=a[1]);return b};t.Db={};t.Db.create=function(a){var b=new t.ta(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b};t.Db.Kb=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};t.J={};t.J.create=function(a){var b=new t.ta(3);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2]);return b};t.J.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b}; t.J.add=function(a,b,c){if(!c||a==c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c};t.J.rd=function(a,b,c){if(!c||a==c)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c};t.J.kd=function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};t.J.scale=function(a,b,c){if(!c||a==c)return a[0]*=b,a[1]*=b,a[2]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c}; t.J.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=Math.sqrt(c*c+d*d+e*e);if(g){if(1==g)return b[0]=c,b[1]=d,b[2]=e,b}else return b[0]=0,b[1]=0,b[2]=0,b;g=1/g;b[0]=c*g;b[1]=d*g;b[2]=e*g;return b};t.J.dd=function(a,b,c){c||(c=a);var d=a[0],e=a[1];a=a[2];var g=b[0],h=b[1];b=b[2];c[0]=e*b-a*h;c[1]=a*g-d*b;c[2]=d*h-e*g;return c};t.J.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};t.J.Kb=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}; t.J.direction=function(a,b,c){c||(c=a);var d=a[0]-b[0],e=a[1]-b[1];a=a[2]-b[2];b=Math.sqrt(d*d+e*e+a*a);if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/b;c[0]=d*b;c[1]=e*b;c[2]=a*b;return c};t.J.fd=function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);return d};t.J.Ab=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};t.Y={}; t.Y.create=function(a){var b=new t.ta(9);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9]);return b};t.Y.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};t.Y.Ub=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a}; t.Y.xa=function(a,b){if(!b||a==b){var c=a[1],d=a[2],e=a[5];a[1]=a[3];a[2]=a[6];a[3]=c;a[5]=a[7];a[6]=d;a[7]=e;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b};t.Y.Zc=function(a,b){b||(b=t.a.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=0;b[4]=a[3];b[5]=a[4];b[6]=a[5];b[7]=0;b[8]=a[6];b[9]=a[7];b[10]=a[8];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b}; t.Y.Ab=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"};t.a={};t.a.create=function(a){var b=new t.ta(16);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b}; t.a.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};t.a.Ub=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}; t.a.xa=function(a,b){if(!b||a==b){var c=a[1],d=a[2],e=a[3],g=a[6],h=a[7],k=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=c;a[6]=a[9];a[7]=a[13];a[8]=d;a[9]=g;a[11]=a[14];a[12]=e;a[13]=h;a[14]=k;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b}; t.a.ed=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],g=a[4],h=a[5],k=a[6],l=a[7],m=a[8],n=a[9],p=a[10],q=a[11],r=a[12],s=a[13],v=a[14];a=a[15];return r*n*k*e-m*s*k*e-r*h*p*e+g*s*p*e+m*h*v*e-g*n*v*e-r*n*d*l+m*s*d*l+r*c*p*l-b*s*p*l-m*c*v*l+b*n*v*l+r*h*d*q-g*s*d*q-r*c*k*q+b*s*k*q+g*c*v*q-b*h*v*q-m*h*d*a+g*n*d*a+m*c*k*a-b*n*k*a-g*c*p*a+b*h*p*a}; t.a.inverse=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=a[3],h=a[4],k=a[5],l=a[6],m=a[7],n=a[8],p=a[9],q=a[10],r=a[11],s=a[12],v=a[13],x=a[14],y=a[15],G=c*k-d*h,H=c*l-e*h,z=c*m-g*h,A=d*l-e*k,B=d*m-g*k,C=e*m-g*l,D=n*v-p*s,E=n*x-q*s,F=n*y-r*s,J=p*x-q*v,K=p*y-r*v,L=q*y-r*x,w=1/(G*L-H*K+z*J+A*F-B*E+C*D);b[0]=(k*L-l*K+m*J)*w;b[1]=(-d*L+e*K-g*J)*w;b[2]=(v*C-x*B+y*A)*w;b[3]=(-p*C+q*B-r*A)*w;b[4]=(-h*L+l*F-m*E)*w;b[5]=(c*L-e*F+g*E)*w;b[6]=(-s*C+x*z-y*H)*w;b[7]=(n*C-q*z+r*H)*w;b[8]=(h*K-k*F+m*D)*w;b[9]= (-c*K+d*F-g*D)*w;b[10]=(s*B-v*z+y*G)*w;b[11]=(-n*B+p*z-r*G)*w;b[12]=(-h*J+k*E-l*D)*w;b[13]=(c*J-d*E+e*D)*w;b[14]=(-s*A+v*H-x*G)*w;b[15]=(n*A-p*H+q*G)*w;return b};t.a.td=function(a,b){b||(b=t.a.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b}; t.a.Yc=function(a,b){b||(b=t.Y.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b};t.a.sd=function(a,b){var c=a[0],d=a[1],e=a[2],g=a[4],h=a[5],k=a[6],l=a[8],m=a[9],n=a[10],p=n*h-k*m,q=-n*g+k*l,r=m*g-h*l,s=c*p+d*q+e*r;if(!s)return null;s=1/s;b||(b=t.Y.create());b[0]=p*s;b[1]=(-n*d+e*m)*s;b[2]=(k*d-e*h)*s;b[3]=q*s;b[4]=(n*c-e*l)*s;b[5]=(-k*c+e*g)*s;b[6]=r*s;b[7]=(-m*c+d*l)*s;b[8]=(h*c-d*g)*s;return b}; t.a.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],g=a[2],h=a[3],k=a[4],l=a[5],m=a[6],n=a[7],p=a[8],q=a[9],r=a[10],s=a[11],v=a[12],x=a[13],y=a[14];a=a[15];var G=b[0],H=b[1],z=b[2],A=b[3],B=b[4],C=b[5],D=b[6],E=b[7],F=b[8],J=b[9],K=b[10],L=b[11],w=b[12],aa=b[13],ba=b[14];b=b[15];c[0]=G*d+H*k+z*p+A*v;c[1]=G*e+H*l+z*q+A*x;c[2]=G*g+H*m+z*r+A*y;c[3]=G*h+H*n+z*s+A*a;c[4]=B*d+C*k+D*p+E*v;c[5]=B*e+C*l+D*q+E*x;c[6]=B*g+C*m+D*r+E*y;c[7]=B*h+C*n+D*s+E*a;c[8]=F*d+J*k+K*p+L*v;c[9]=F*e+J*l+K*q+L*x;c[10]=F* g+J*m+K*r+L*y;c[11]=F*h+J*n+K*s+L*a;c[12]=w*d+aa*k+ba*p+b*v;c[13]=w*e+aa*l+ba*q+b*x;c[14]=w*g+aa*m+ba*r+b*y;c[15]=w*h+aa*n+ba*s+b*a;return c};t.a.Ua=function(a,b,c){c||(c=b);var d=b[0],e=b[1];b=b[2];c[0]=a[0]*d+a[4]*e+a[8]*b+a[12];c[1]=a[1]*d+a[5]*e+a[9]*b+a[13];c[2]=a[2]*d+a[6]*e+a[10]*b+a[14];return c}; t.a.Gc=function(a,b){var c;c||(c=b);var d=b[0],e=b[1],g=b[2];b=b[3];c[0]=a[0]*d+a[4]*e+a[8]*g+a[12]*b;c[1]=a[1]*d+a[5]*e+a[9]*g+a[13]*b;c[2]=a[2]*d+a[6]*e+a[10]*g+a[14]*b;c[3]=a[3]*d+a[7]*e+a[11]*g+a[15]*b;return c}; t.a.translate=function(a,b,c){var d=b[0],e=b[1];b=b[2];if(!c||a==c)return a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a;var g=a[0],h=a[1],k=a[2],l=a[3],m=a[4],n=a[5],p=a[6],q=a[7],r=a[8],s=a[9],v=a[10],x=a[11];c[0]=g;c[1]=h;c[2]=k;c[3]=l;c[4]=m;c[5]=n;c[6]=p;c[7]=q;c[8]=r;c[9]=s;c[10]=v;c[11]=x;c[12]=g*d+m*e+r*b+a[12];c[13]=h*d+n*e+s*b+a[13];c[14]=k*d+p*e+v*b+a[14];c[15]=l*d+q*e+x*b+a[15];return c}; t.a.scale=function(a,b,c){var d=b[0],e=b[1];b=b[2];if(!c||a==c)return a[0]*=d,a[1]*=d,a[2]*=d,a[3]*=d,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d;c[4]=a[4]*e;c[5]=a[5]*e;c[6]=a[6]*e;c[7]=a[7]*e;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c}; t.a.rotate=function(a,b,c,d){var e=c[0],g=c[1];c=c[2];var h=Math.sqrt(e*e+g*g+c*c);if(!h)return null;1!=h&&(h=1/h,e*=h,g*=h,c*=h);var k=Math.sin(b),l=Math.cos(b),m=1-l;b=a[0];var h=a[1],n=a[2],p=a[3],q=a[4],r=a[5],s=a[6],v=a[7],x=a[8],y=a[9],G=a[10],H=a[11],z=e*e*m+l,A=g*e*m+c*k,B=c*e*m-g*k,C=e*g*m-c*k,D=g*g*m+l,E=c*g*m+e*k,F=e*c*m+g*k,e=g*c*m-e*k,g=c*c*m+l;d?a!=d&&(d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[0]=b*z+q*A+x*B;d[1]=h*z+r*A+y*B;d[2]=n*z+s*A+G*B;d[3]=p*z+v*A+H*B;d[4]=b*C+q* D+x*E;d[5]=h*C+r*D+y*E;d[6]=n*C+s*D+G*E;d[7]=p*C+v*D+H*E;d[8]=b*F+q*e+x*g;d[9]=h*F+r*e+y*g;d[10]=n*F+s*e+G*g;d[11]=p*F+v*e+H*g;return d};t.a.nd=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[4],g=a[5],h=a[6],k=a[7],l=a[8],m=a[9],n=a[10],p=a[11];c?a!=c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[4]=e*b+l*d;c[5]=g*b+m*d;c[6]=h*b+n*d;c[7]=k*b+p*d;c[8]=e*-d+l*b;c[9]=g*-d+m*b;c[10]=h*-d+n*b;c[11]=k*-d+p*b;return c}; t.a.od=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],g=a[1],h=a[2],k=a[3],l=a[8],m=a[9],n=a[10],p=a[11];c?a!=c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+l*-d;c[1]=g*b+m*-d;c[2]=h*b+n*-d;c[3]=k*b+p*-d;c[8]=e*d+l*b;c[9]=g*d+m*b;c[10]=h*d+n*b;c[11]=k*d+p*b;return c}; t.a.pd=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],g=a[1],h=a[2],k=a[3],l=a[4],m=a[5],n=a[6],p=a[7];c?a!=c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+l*d;c[1]=g*b+m*d;c[2]=h*b+n*d;c[3]=k*b+p*d;c[4]=e*-d+l*b;c[5]=g*-d+m*b;c[6]=h*-d+n*b;c[7]=k*-d+p*b;return c}; t.a.yc=function(a,b,c,d,e,g,h){h||(h=t.a.create());var k=b-a,l=d-c,m=g-e;h[0]=2*e/k;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*e/l;h[6]=0;h[7]=0;h[8]=(b+a)/k;h[9]=(d+c)/l;h[10]=-(g+e)/m;h[11]=-1;h[12]=0;h[13]=0;h[14]=-(g*e*2)/m;h[15]=0;return h};t.a.perspective=function(a,b,c,d,e){a=c*Math.tan(a*Math.PI/360);b*=a;return t.a.yc(-b,b,-a,a,c,d,e)}; t.a.md=function(a,b,c,d,e,g,h){h||(h=t.a.create());var k=b-a,l=d-c,m=g-e;h[0]=2/k;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2/l;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=-2/m;h[11]=0;h[12]=-(a+b)/k;h[13]=-(d+c)/l;h[14]=-(g+e)/m;h[15]=1;return h}; t.a.gd=function(a,b,c,d){d||(d=t.a.create());var e=a[0],g=a[1];a=a[2];var h=c[0],k=c[1],l=c[2];c=b[1];var m=b[2];if(e==b[0]&&g==c&&a==m)return t.a.Ub(d);var n,p,q,r;c=e-b[0];m=g-b[1];b=a-b[2];r=1/Math.sqrt(c*c+m*m+b*b);c*=r;m*=r;b*=r;n=k*b-l*m;l=l*c-h*b;h=h*m-k*c;(r=Math.sqrt(n*n+l*l+h*h))?(r=1/r,n*=r,l*=r,h*=r):h=l=n=0;k=m*h-b*l;p=b*n-c*h;q=c*l-m*n;(r=Math.sqrt(k*k+p*p+q*q))?(r=1/r,k*=r,p*=r,q*=r):q=p=k=0;d[0]=n;d[1]=k;d[2]=c;d[3]=0;d[4]=l;d[5]=p;d[6]=m;d[7]=0;d[8]=h;d[9]=q;d[10]=b;d[11]=0;d[12]= -(n*e+l*g+h*a);d[13]=-(k*e+p*g+q*a);d[14]=-(c*e+m*g+b*a);d[15]=1;return d};t.a.Ab=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"};t.O={};t.O.create=function(a){var b=new t.ta(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b};t.O.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b}; t.O.cd=function(a,b){var c=a[0],d=a[1],e=a[2];if(!b||a==b)return a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a;b[0]=c;b[1]=d;b[2]=e;b[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e));return b};t.O.inverse=function(a,b){if(!b||a==b)return a[0]*=1,a[1]*=1,a[2]*=1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};t.O.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)}; t.O.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=a[3],h=Math.sqrt(c*c+d*d+e*e+g*g);if(0==h)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;h=1/h;b[0]=c*h;b[1]=d*h;b[2]=e*h;b[3]=g*h;return b};t.O.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],g=a[2];a=a[3];var h=b[0],k=b[1],l=b[2];b=b[3];c[0]=d*b+a*h+e*l-g*k;c[1]=e*b+a*k+g*h-d*l;c[2]=g*b+a*l+d*k-e*h;c[3]=a*b-d*h-e*k-g*l;return c}; t.O.Ua=function(a,b,c){c||(c=b);var d=b[0],e=b[1],g=b[2];b=a[0];var h=a[1],k=a[2];a=a[3];var l=a*d+h*g-k*e,m=a*e+k*d-b*g,n=a*g+b*e-h*d,d=-b*d-h*e-k*g;c[0]=l*a+d*-b+m*-k-n*-h;c[1]=m*a+d*-h+n*-b-l*-k;c[2]=n*a+d*-k+l*-h-m*-b;return c};t.O.Yc=function(a,b){b||(b=t.Y.create());var c=a[0],d=a[1],e=a[2],g=a[3],h=c+c,k=d+d,l=e+e,m=c*h,n=c*k,c=c*l,p=d*k,d=d*l,e=e*l,h=g*h,k=g*k,g=g*l;b[0]=1-(p+e);b[1]=n-g;b[2]=c+k;b[3]=n+g;b[4]=1-(m+e);b[5]=d-h;b[6]=c-k;b[7]=d+h;b[8]=1-(m+p);return b}; t.O.Zc=function(a,b){b||(b=t.a.create());var c=a[0],d=a[1],e=a[2],g=a[3],h=c+c,k=d+d,l=e+e,m=c*h,n=c*k,c=c*l,p=d*k,d=d*l,e=e*l,h=g*h,k=g*k,g=g*l;b[0]=1-(p+e);b[1]=n-g;b[2]=c+k;b[3]=0;b[4]=n+g;b[5]=1-(m+e);b[6]=d-h;b[7]=0;b[8]=c-k;b[9]=d+h;b[10]=1-(m+p);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};t.O.qd=function(a,b,c,d){d||(d=a);var e=c;0>a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]&&(e=-1*c);d[0]=1-c*a[0]+e*b[0];d[1]=1-c*a[1]+e*b[1];d[2]=1-c*a[2]+e*b[2];d[3]=1-c*a[3]+e*b[3];return d}; t.O.Ab=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};t.zc=function(a,b,c,d,e,g){var h=b-a,k=d-c,l=g-e;a=t.a.create([2*e/h,0,(b+a)/h,0,0,2*e/k,(d+c)/k,0,0,0,-(g+e)/l,-2*g*e/l,0,0,-1,0]);t.a.xa(a);return a};t.Mc=function(a,b,c,d){a=c*Math.tan(a*Math.PI/360);b*=a;return t.zc(-b,b,-a,a,c,d)}; t.Ga=function(a,b){var c=Math.cos(b),d=Math.sin(b);switch(a){case 0:c=t.a.create([1,0,0,0,0,c,-d,0,0,d,c,0,0,0,0,1]);break;case 1:c=t.a.create([c,0,-d,0,0,1,0,0,d,0,c,0,0,0,0,1]);break;default:c=t.a.create([c,-d,0,0,d,c,0,0,0,0,1,0,0,0,0,1])}t.a.xa(c);return c};t.ab=function(a,b,c){a=t.a.create([a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1]);t.a.xa(a);return a};t.Rc=function(a){return t.ab(a,a,a)};t.qa=function(a,b,c){a=t.a.create([1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1]);t.a.xa(a);return a}; t.ud=function(a){return t.qa(a[0],a[1],0)};t.vd=function(a){return t.qa(a[0],a[1],a[2])};t.ja=function(a,b,c){a<b?a=b:a>c&&(a=c);return a};t.ea=function(a){return a*Math.PI/180};t.gc=function(a){var b=7;if(0>a)return a=-a+"",b--,a.length>=b?"-"+a:"-"+(Array(b-a.length+1).join("0")+a);a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a};t.Tc=function(a,b){return a.replace(/\{([_$a-zA-Z0-9][_$a-zA-Z0-9]*)\}/g,function(a,d){return d in b?b[d]:a})}; t.Xb=function(a,b,c){var d=new XMLHttpRequest;d.onload=function(){var a=d.response;try{var g=eval("("+a+")")}catch(h){null!=c&&c();return}null!=b&&b(g)}.bind(this);d.onerror=function(){null!=c&&c()}.bind(this);d.open("GET",a,!0);d.send("")}; t.Wb=function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){switch(d.readyState){case 0:case 1:case 2:case 3:break;case 4:if(404==d.status){null!=c&&c();break}var a=new DataView(d.response);null!=b&&b(a);break;default:null!=c&&c()}}.bind(this);d.onerror=function(){null!=c&&c()}.bind(this);d.open("GET",a,!0);d.responseType="arraybuffer";d.send("")};window.performance=window.performance||{}; performance.now=performance.now||performance.hd||performance.jd||performance.ld||performance.webkitNow||function(){return(new Date).getTime()};window.jc=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}; function ca(a,b,c){this.u=new u(a);this.ac=this.bc=this.kb=0;this.Qa=[];this.Pa=[0,0,0];this.uc=c;this.nc=this.$b=this.cc="";null!=b.foat&&(this.u.j=b.foat[0],this.u.p=b.foat[1],this.u.r=b.foat[2],this.kb=b.foat[3]);null!=b.meta&&(this.bc=b.meta[0],this.ac=b.meta[1]);this.cc=b.metaTemplate;this.$b=b.meshTemplate;this.nc=b.textureTemplate;if(null!=b.defaultPosition&&null!=b.defaultOrientation)for(a=0;3>a;a++)this.Qa[a]=b.defaultPosition[a],this.Pa[a]=b.defaultOrientation[a]} function I(a,b){return b>a.u.j?a.kb>>b-a.u.j:a.kb<<a.u.j-b}function da(a,b){return ea(a,a.cc,b)}function fa(a,b){return ea(a,a.$b,b)}function ha(a,b){return ea(a,a.nc,b)}function ea(a,b,c){b=t.Tc(b,{lod:c.j,easting:t.gc(c.p),northing:t.gc(c.r)});return a.uc+b}function ia(a,b,c){var d=I(a,10),e=Math.round((b[0]-a.u.p)/d),g=Math.round((b[1]-a.u.r)/d);return null!=c?(c[0]=a.u.p+e*d,c[1]=a.u.r+g*d,c[2]=b[2],c):[a.u.p+e*d,a.u.r+g*d,b[2]]} function ja(a){this.hb=1073741824;this.Qb=402653184;this.Ca=4;this.Hb=45;this.ib=6E5;this.Rb=8;this.Sb=32;this.pa="./skydome.jpg";this.ka=[0.8,0.8,0.8];this.da="observer";if(null!=a&&(null!=a.cacheSize&&(this.hb=a.cacheSize),null!=a.gpuCacheSize&&(this.Qb=a.gpuCacheSize),null!=a.numThreads&&(this.Ca=a.numThreads),null!=a.cameraFOV&&(this.Hb=a.cameraFOV),null!=a.cameraVisibility&&(this.ib=a.cameraVisibility),null!=a.gridEmbeddingFactor&&(this.Rb=a.gridEmbeddingFactor),null!=a.gridMinTileSize&&(this.Sb= a.gridMinTileSize),null!=a.skydomeTexture&&(this.pa=a.skydomeTexture),null!=a.controlMode&&(this.da=a.controlMode),null!=a.controlInertia))for(var b=0;3>b;b++)this.ka[b]=a.controlInertia[b]} function ka(a,b,c,d,e,g){this.f=[];this.i=[];this.f[0]=null!=a?a:Number.POSITIVE_INFINITY;this.f[1]=null!=b?b:Number.POSITIVE_INFINITY;this.f[2]=null!=c?c:Number.POSITIVE_INFINITY;this.i[0]=null!=d?d:Number.NEGATIVE_INFINITY;this.i[1]=null!=e?e:Number.NEGATIVE_INFINITY;this.i[2]=null!=g?g:Number.NEGATIVE_INFINITY}function M(a,b){return a.i[b]-a.f[b]}function la(a,b){return new ka(a.f[0]-b[0],a.f[1]-b[1],a.f[2],a.i[0]-b[0],a.i[1]-b[1],a.i[2])} function ma(a){this.na=[];this.Ta=null!=a?a:Number.MAX_VALUE;this.L=this.V=null;this.ha=0}f=ma.prototype;f.log=function(){for(var a=0,b=this.L;null!=b.$&&!(b=this.na[b.$][3],a++,10<a););this.na.forEach(function(){})};f.find=function(a){a=this.hash(a);a=this.na[a];if(null!=a){if(this.L!=a){null!=a.aa&&(a.aa.$=a.$);null!=a.$&&(a.$.aa=a.aa);this.V==a&&(this.V=a.aa);var b=this.L;this.L=a;this.L.$=b;this.L.aa=null;b.aa=this.L}return a.Sa}return null};f.contains=function(a){return null!=this.na[this.hash(a)]}; f.clear=function(){for(var a=this.L;null!=a;)null!=a.Sa&&a.Sa.w(),a=a.$;this.na=[];this.L=this.V=null;this.ha=0};function na(a,b,c,d){b=a.hash(b);c={Ac:b,Sa:c,vc:d,aa:null,$:a.L};null!=a.L&&(a.L.aa=c);a.L=c;null==a.V&&(a.V=c);a.na[b]=c;a.ha+=d;oa(a)}function oa(a){for(;a.ha>a.Ta;){var b=a.V;if(null!=b)a.V=a.V.aa,null!=a.V&&(a.V.$=null),a.na[b.Ac]=null,a.ha-=b.vc,b.Sa.w();else break}}f.hash=function(a){return""+Math.round(a.j)+"."+Math.round(a.p)+"."+Math.round(a.r)}; function pa(a,b,c,d,e){null==d&&(d=1);this.b=a;this.Ca=d;this.fb=0;this.D=new ma(b);this.oa=[];this.Wa=[];this.ma=[];this.dc=c;this.Lb=e}f=pa.prototype;f.get=function(a){var b=this.D.find(a);null==b&&this.ub(a);return b};f.contains=function(a){return this.D.contains(a)};f.trim=function(a){var b=this.D.Ta,c=this.D;c.Ta=a;oa(c);a=this.D;a.Ta=b;oa(a)};f.reset=function(){this.D.clear()};f.size=function(){return this.D.ha}; f.ub=function(a){var b=this.D.hash(a),c=this.ma.indexOf(b);-1==c&&(c=this.oa.indexOf(b),-1!=c&&(this.oa.splice(c,1),this.Wa.splice(c,1)),this.oa.unshift(b),this.Wa.unshift(a),20<this.oa.length&&(this.oa.pop(),this.Wa.pop()))}; f.update=function(){if(0<this.oa.length&&this.fb<this.Ca){var a=this.oa.shift(),b=this.Wa.shift();if(-1==this.ma.indexOf(a)){this.ma.push(a);this.fb++;var a=function(a,b){this.ma.splice(this.ma.indexOf(this.D.hash(a)),1);this.fb--;na(this.D,a,b,b.size());null!=this.dc&&this.dc(a)}.bind(this),c=function(a){this.ma.splice(this.ma.indexOf(this.D.hash(a)),1);this.fb--}.bind(this);null!=this.Lb&&new this.Lb(this.b,b,a,c)}}}; function qa(a,b,c){this.c=[0,0,0];this.g=[0,0,0];this.Gb=1;this.Ob=a;this.tb=b;this.ya=c;this.Z=t.a.create();this.Xa=t.a.create();this.Va=t.a.create();this.X=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];this.kc=[0,0,0,0];this.B=!0}f=qa.prototype;f.Ia=function(a){this.c=a;this.B=!0};f.Ha=function(a){this.g=a;this.B=!0};f.sa=function(){return[this.c[0],this.c[1],this.c[2]]};f.mb=function(){return[this.g[0],this.g[1],this.g[2]]};function ra(a){a.B&&a.update();return a.Z} function sa(a){a.B&&a.update();return a.Xa}function ta(a){a.B&&a.update();return a.Va}function ua(a,b){a.B&&a.update();for(var c=[[b.f[0],b.f[1],b.f[2],1],[b.f[0],b.f[1],b.i[2],1],[b.f[0],b.i[1],b.f[2],1],[b.f[0],b.i[1],b.i[2],1],[b.i[0],b.f[1],b.f[2],1],[b.i[0],b.f[1],b.i[2],1],[b.i[0],b.i[1],b.f[2],1],[b.i[0],b.i[1],b.i[2],1]],d=0;6>d;d++){for(var e=!0,g=0;8>g;g++)if(0<=t.Db.Kb(a.X[d],c[g])){e=!1;break}if(e)return!1}return!0} f.update=function(){this.Z=t.a.create();t.a.multiply(t.Ga(1,t.ea(-this.g[2])),t.Ga(0,t.ea(-this.g[1]-90)),this.Z);t.a.multiply(this.Z,t.Ga(2,t.ea(-this.g[0])),this.Z);t.a.multiply(this.Z,t.qa(-this.c[0],-this.c[1],-this.c[2]),this.Z);this.Xa=t.Mc(this.Ob,this.Gb,this.tb,this.ya);this.Va=t.a.create();t.a.multiply(this.Xa,this.Z,this.Va);this.X[0]=[0,0,1,1];this.X[1]=[0,0,-1,1];this.X[2]=[1,0,0,1];this.X[3]=[-1,0,0,1];this.X[4]=[0,1,0,1];this.X[5]=[0,-1,0,1];var a=t.a.create();t.a.xa(this.Va,a);for(var b= 0;6>b;b++)this.X[b]=t.a.Gc(a,this.X[b]);this.B=!1};t.mc=function(a,b,c,d,e,g){var h=e.get(c);if(!h)return[d,c.j>=g];var k=I(a.n,c.j);d=(b[0]-c.p)/k;k=(b[1]-c.r)/k;d=t.ja(d,0,0.9999);var k=t.ja(k,0,0.9999),l=t.ia,m=d*(l-1),n=k*(l-1),p=Math.floor(m),q=Math.floor(n),r=h.Q[q*l+p],s=h.Q[(q+1)*l+p],m=m-p,r=r+(h.Q[q*l+p+1]-r)*m,l=r+(s+(h.Q[(q+1)*l+p+1]-s)*m-r)*(n-q),n=0,n=0.5>k?0.5>d?0:1:0.5>d?2:3;return!(h.T&1<<n)||c.j>=g?[l,!0]:t.mc(a,b,N(c,n),l,e)}; t.Ma=function(a,b,c){var d;null==d&&(d=Number.MAX_VALUE);return t.mc(a,b,a.n.u,0,c,d)};function O(a,b){this.H=a;this.A=null;this.G=b;this.Jb=null} function va(a){a.A=document.createElement("canvas");if(null!=a.A&&(a.A.width=a.G[0],a.A.height=a.G[1],a.A.style.display="block",null!=a.A.getContext)){try{a.e=a.A.getContext("webgl")||a.A.getContext("experimental-webgl")}catch(b){}a.e&&(a.H.appendChild(a.A),a.e.Fb=a.A.width,a.e.Eb=a.A.height,a.e.clearColor(0,0,0,1),a.e.enable(a.e.DEPTH_TEST),a.e.viewport(0,0,a.e.Fb,a.e.Eb),a.e.clear(a.e.COLOR_BUFFER_BIT|a.e.DEPTH_BUFFER_BIT))}} O.prototype.resize=function(a){this.G=a;null!=this.A&&(this.A.width=this.G[0],this.A.height=this.G[1]);null!=this.e&&(this.e.Fb=this.A.width,this.e.Eb=this.A.height)};O.prototype.clear=function(){this.e.viewport(0,0,this.e.Fb,this.e.Eb);this.e.clear(this.e.DEPTH_BUFFER_BIT);this.e.enable(this.e.CULL_FACE)};O.prototype.useProgram=function(a,b,c){this.Jb!=a&&(this.e.useProgram(a.W),this.Jb=a,wa(a),b=a.getAttribute(b),a=a.getAttribute(c),this.e.enableVertexAttribArray(b),this.e.enableVertexAttribArray(a))}; O.prototype.bindTexture=function(a){!1!=a.rb&&(this.e.activeTexture(this.e.TEXTURE0),this.e.bindTexture(this.e.TEXTURE_2D,a.S))};t.bd=function(){return!0}; function P(a,b,c){this.h=b.h;this.e=a.e;this.Ra=c;a=this.e;null!=a&&(this.ra=this.ca=null,this.ca=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.ca),a.bufferData(a.ARRAY_BUFFER,new Float32Array(b.o),a.STATIC_DRAW),this.ca.pb=3,this.ca.vb=b.o.length/3,this.ra=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.ra),a.bufferData(a.ARRAY_BUFFER,new Float32Array(b.s),a.STATIC_DRAW),this.ra.pb=2,this.ra.vb=b.s.length/2,this.P=4*(b.o.length+b.s.length)+32,this.wb=this.ca.vb/3)} P.prototype.w=function(){this.e.deleteBuffer(this.ca);this.e.deleteBuffer(this.ra)};function xa(a,b){var c=a.e;if(null!=c){var d=b.getAttribute("aPosition"),e=b.getAttribute("aTexCoord");c.bindBuffer(c.ARRAY_BUFFER,a.ca);c.vertexAttribPointer(d,a.ca.pb,c.FLOAT,!1,0,0);c.bindBuffer(c.ARRAY_BUFFER,a.ra);c.vertexAttribPointer(e,a.ra.pb,c.FLOAT,!1,0,0);c.drawArrays(c.TRIANGLES,0,a.ca.vb)}}P.prototype.size=function(){return this.P}; function Q(a,b,c){this.e=a.e;this.W=null;this.Bb=[];this.gb=[];this.createProgram(b,c)}Q.prototype.createShader=function(a,b){if(!a)return null;var c=this.e;if(null!=c){var d;d=!0!=b?c.createShader(c.FRAGMENT_SHADER):c.createShader(c.VERTEX_SHADER);c.shaderSource(d,a);c.compileShader(d);return c.getShaderParameter(d,c.COMPILE_STATUS)?d:(alert("An error occurred compiling the shaders: "+c.getShaderInfoLog(d)),null)}}; Q.prototype.createProgram=function(a,b){var c=this.e;if(null!=c){var d=this.createShader(a,!0),e=this.createShader(b,!1),g=c.createProgram();c.attachShader(g,d);c.attachShader(g,e);c.linkProgram(g);c.getProgramParameter(g,c.LINK_STATUS)||alert("Unable to initialize the shader program.");c.useProgram(g);this.W=g}};function wa(a){var b=a.e;null!=b&&null!=a.W&&(a=a.getUniform("uSampler"),null!=a&&b.uniform1i(a,0))} function R(a,b,c){var d=a.e;null!=d&&null!=a.W&&(a=a.getUniform(b),null!=a&&d.uniformMatrix4fv(a,!1,c))}function ya(a,b,c){var d=a.e;null!=d&&null!=a.W&&(a=a.getUniform(b),null!=a&&d.uniform1f(a,c))}Q.prototype.getAttribute=function(a){var b=this.e;if(null!=b&&null!=this.W)return null==this.gb[a]?(b=b.getAttribLocation(this.W,a),this.gb[a]=b):this.gb[a]}; Q.prototype.getUniform=function(a){var b=this.e;if(null!=b&&null!=this.W)return null==this.Bb[a]?(b=b.getUniformLocation(this.W,a),this.Bb[a]=b):this.Bb[a]};t.Vc="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMVP;\nvarying vec2 vTexCoord;\nvoid main(){ \ngl_Position = uMVP * vec4(aPosition, 1.0);\nvTexCoord = aTexCoord;\n}";t.Uc="precision mediump float;\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nconst vec4 gray = vec4(0.125, 0.125, 0.125, 1.0);\nvoid main() {\nfloat fade = smoothstep(0.51, 0.55, vTexCoord.t);\ngl_FragColor = mix(texture2D(uSampler, vTexCoord), gray, fade);\n}"; t.Dc="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nuniform mat4 uGridMat;\nuniform float uGridStep1, uGridStep2;\nconst int HMSize = 5;\nconst float HMSize1 = float(HMSize-1);\nuniform float uHeight[HMSize*HMSize];\nvarying vec2 vTexCoord1;\nvarying vec2 vTexCoord2;\nvarying float vFogFactor;\nfloat round(float x) { return floor(x + 0.5); }\nvoid main() {\nvec3 pos = aPosition;\nfloat z = uHeight[int(round(pos.y*HMSize1)*float(HMSize) + round(pos.x*HMSize1))];\nvec4 camSpacePos = uMV * vec4(pos.xy, z, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\nvec4 gridCoord = uGridMat * vec4(pos, 1.0);\nvTexCoord1 = aTexCoord;\nvTexCoord1 = gridCoord.xy * vec2(uGridStep1);\nvTexCoord2 = gridCoord.xy * vec2(uGridStep2);\n}"; t.Bc="precision mediump float;\nuniform sampler2D uSampler;\nuniform float uGridBlend;\nvarying vec2 vTexCoord1;\nvarying vec2 vTexCoord2;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(1, 1, 1, 1);\nvoid main() {\nvec4 gridColor = mix(texture2D(uSampler, vTexCoord1), texture2D(uSampler, vTexCoord2), uGridBlend);\ngl_FragColor = mix(fogColor, gridColor, vFogFactor);\n}";t.Xc="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\nvTexCoord = aTexCoord;\n}"; t.Wc="precision mediump float;\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(1, 1, 1, 1);\nvoid main() {\ngl_FragColor = mix(fogColor, texture2D(uSampler, vTexCoord), vFogFactor);\n}";function S(a,b,c,d){this.e=a.e;this.S=null;this.P=0;this.Ra=d;this.F=null;this.rb=!1;this.b=c;null!=b&&this.load(b)}S.prototype.w=function(){this.e.deleteTexture(this.S)};S.prototype.size=function(){return this.P}; function za(a,b,c){var d=a.e;a.S=d.createTexture();d.bindTexture(d.TEXTURE_2D,a.S);c=!0==c?d.REPEAT:d.CLAMP_TO_EDGE;d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,c);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,c);c=!1;switch("linear"){case "linear":d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR);break;case "trilinear":d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR_MIPMAP_LINEAR);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER, d.LINEAR);c=!0;break;default:d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST)}d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,b);!0==c&&d.generateMipmap(d.TEXTURE_2D);d.bindTexture(d.TEXTURE_2D,null);a.P=b.naturalWidth*b.naturalHeight*4;a.rb=!0} S.prototype.load=function(a,b,c){this.F=new Image;this.F.crossOrigin="anonymous";this.F.onload=function(){if(null==this.b||!0!=this.b.m)za(this,this.F,!1),this.F=null}.bind(this);this.F.onerror=function(){null!=this.b&&!0==this.b.m||null==c||c()}.bind(this);this.F.src=a};function Aa(a,b){this.q=a;this.I=new P(a,b.I);this.S=new S(a);za(this.S,b.F);this.sb=b.sb;this.ob=b.ob}Aa.prototype.w=function(){this.I.w();this.S.w()};Aa.prototype.size=function(){return this.I.size()+this.S.size()}; function Ba(a,b){this.q=a;this.D=new ma(b)}Ba.prototype.get=function(a,b){var c=this.D.find(a);if(c)return c;c=new Aa(this.q,b);na(this.D,a,c,c.size());return c};Ba.prototype.size=function(){return this.D.ha};Ba.prototype.reset=function(){return this.D.clear()};function T(){this.o=[];this.s=[];this.h=new ka;this.Ra=this.P=0}T.prototype.w=function(){this.o=[];this.s=[];this.h=null}; T.prototype.load=function(a,b,c){t.Wb(a,function(a){this.Ra=a.byteLength;for(var c=0,g=1/65535,h="",k=0;8>k;k++)h+=String.fromCharCode(a.getUint8(c,!0)),c+=1;if("BIN.MESH"==h&&(k=a.getUint32(c,!0),c+=4,!(1<k))){for(k=0;3>k;k++)this.h.f[k]=a.getFloat64(c,!0),c+=8;for(k=0;3>k;k++)this.h.i[k]=a.getFloat64(c,!0),c+=8;for(var h=a.getUint16(c,!0),c=c+2,l=Array(3*h),m=0;m<h;m++)k=3*m,l[k]=a.getUint16(c,!0),c+=2,l[k+1]=a.getUint16(c,!0),c+=2,l[k+2]=a.getUint16(c,!0),c+=2;for(var h=a.getUint16(c,!0),c=c+2, n=Array(2*h),m=0;m<h;m++)k=2*m,n[k]=a.getUint16(c,!0),c+=2,n[k+1]=65535-a.getUint16(c,!0),c+=2;h=a.getUint16(c,!0);c+=2;this.o=Array(9*h);this.s=Array(6*h);for(m=0;m<h;m++){for(k=0;3>k;k++){var p=3*a.getUint16(c,!0),c=c+2,q=9*m+3*k;this.o[q]=l[p]*g;this.o[q+1]=l[p+1]*g;this.o[q+2]=l[p+2]*g}for(k=0;3>k;k++)p=2*a.getUint16(c,!0),c+=2,q=6*m+2*k,this.s[q]=n[p]*g,this.s[q+1]=n[p+1]*g}this.P=8*(this.o.length+this.s.length)+56;null!=b&&b()}}.bind(this),function(){null!=c&&c()}.bind(this))}; T.prototype.size=function(){return this.P};T.prototype.fileSize=function(){return this.Ra};t.cb=function(a,b){b*=Math.PI;a=2*a*Math.PI;return[Math.cos(a)*Math.sin(b)*0.5+0.5,Math.sin(a)*Math.sin(b)*0.5+0.5,0.5*Math.cos(b)+0.5]};t.ia=5; function Ca(a,b,c){this.b=a;this.h=new ka;this.ua=[];this.Q=[];this.T=0;this.Ka=[];for(a=0;2>a;a++)this.ua[a]=[];var d=c.la.getInt16(c.t,!0);c.t+=2;a=c.la.getInt16(c.t,!0);c.t+=2;this.h.f[0]=b.p;this.h.f[1]=b.r;this.h.f[2]=d;d=I(this.b.n,b.j);this.h.i[0]=b.p+d;this.h.i[1]=b.r+d;this.h.i[2]=a;for(a=0;2>a;a++)for(b=0;2>b;b++)this.ua[a][b]=c.la.getFloat32(c.t,!0),c.t+=4;a=0;for(b=t.ia*t.ia;a<b;a++)this.Q[a]=c.la.getInt16(c.t,!0),c.t+=2;for(a=0;4>a;a++)this.Ka[a]=null;this.T=0} Ca.prototype.za=function(a,b){var c=b;null!=c?(c[0]=M(this.h,0),c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=M(this.h,1),c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=this.h.f[0]-a[0],c[13]=this.h.f[1]-a[1],c[14]=0,c[15]=1):(c=t.a.create(),t.a.multiply(t.qa(this.h.f[0]-a[0],this.h.f[1]-a[1],0),t.ab(M(this.h,0),M(this.h,1),1),c));return c};Ca.prototype.size=function(){for(var a=308,b=0;4>b;b++)null!=this.Ka[b]&&(a+=this.Ka[b].size());return a}; function Da(a,b,c){this.v=b;this.b=a;a="";for(var d=0;8>d;d++)a+=String.fromCharCode(c.la.getUint8(c.t,!0)),c.t+=1;"METATILE"==a&&(a=c.la.getUint32(c.t,!0),c.t+=4,1<a||(this.oc=Ea(this,b,c)))}Da.prototype.w=function(){};function Ea(a,b,c){var d=new Ca(a.b,b,c),e=c.la.getUint8(c.t,!0);c.t+=1;for(var g=0;4>g;g++)e&1<<g+4&&(d.Ka[g]=Ea(a,N(b,g),c));d.T=e&15;return d}Da.prototype.size=function(){return this.oc.size()}; t.rc=function(a,b,c,d){this.b=a;this.v=b;this.Ea=c;this.Da=d;this.Ic=function(b){!0!=this.b.m&&null!=this.Ea&&(b=new Da(a,this.v,{la:b,t:0}),this.Ea(this.v,b))}.bind(this);this.Hc=function(){!0!=this.b.m&&null!=this.Da&&this.Da(this.v)}.bind(this);t.Wb(da(this.b.n,this.v),this.Ic,this.Hc)}; function Fa(a,b,c,d,e){this.b=a;this.K=new pa(a,b,c,d,e);this.contains=this.K.contains.bind(this.K);this.trim=this.K.trim.bind(this.K);this.reset=this.K.reset.bind(this.K);this.ub=this.K.ub.bind(this.K);this.update=this.K.update.bind(this.K);this.size=this.K.size.bind(this.K)} Fa.prototype.get=function(a){for(var b=a,c=this.b.n;Math.abs(b.j-c.bc)%c.ac&&b.j>c.u.j;)b=b.parent();if(b=this.K.get(b)){for(var c=new u(b.b,b.v.j,b.v.p,b.v.r),d=b.oc;c.j<a.j;){var e=I(b.b.n,c.j),g=c.p+e/2,e=c.r+e/2,h=0;Math.round(a.p)>=Math.round(g)&&(h|=1,c.p=g);Math.round(a.r)>=Math.round(e)&&(h|=2,c.r=e);c.j++;(d=d.Ka[h])||console.log("Missing tile metadata")}!c.isEqual(a)&&console.log("Metatile inconsistency");a=d}else a=null;return a};t.zb=1.1; function Ga(a,b,c){this.b=a;this.Fa=this.R=this.va=null;this.H=b;this.fc=c;this.m=!1;this.G=[b.clientWidth,b.clientHeight];this.Na=!1;this.B=this.Tb=!0;this.Fc=1;this.q=new O(b,this.G);this.k=new qa(this.b.l.Hb,20,this.b.l.ib);this.c=[this.b.n.Qa[0],this.b.n.Qa[1],this.b.n.Qa[2]];this.g=[this.b.n.Pa[0],this.b.n.Pa[1],this.b.n.Pa[2]];this.N=new Fa(this.b,Number.MAX_VALUE,function(){this.B=!0}.bind(this),this.b.l.Ca,t.rc);this.ba=new t.sc(this.b,Number.MAX_VALUE,function(){this.B=!0}.bind(this),this.b.l.Ca, t.tc);this.nb=new Ba(this.q,this.b.l.Qb);this.pa=this.Ja=this.Ba=this.Aa=null;this.Cc=!1;this.qc=!0;this.lc=document.getElementById("renderStats");this.$a=this.ic=this.fa=this.xb=this.yb=this.eb=this.La=0;this.wa=[];this.Ya=this.Za=0;this.qb=null;this.lb=0;this.Yb=!0;this.Nb=t.a.create();this.Mb=t.a.create();this.wc=[0,0,0];this.xc=t.a.create();this.Nc=t.a.create();this.pc=t.a.create();this.Qc=[0,0,0];this.Pc=[[3,1,2,0],[3,2,1,0],[2,3,0,1],[2,0,3,1],[0,2,1,3],[0,1,2,3],[1,0,3,2],[1,3,0,2]];window.addEventListener("resize", this.ec.bind(this));va(this.q);this.va=new Q(this.q,t.Xc,t.Wc);this.R=new Q(this.q,t.Dc,t.Bc);this.Fa=new Q(this.q,t.Vc,t.Uc);Ha(this);Ia(this);Ja(this,this.G[0],this.G[1]);window.jc(this.update.bind(this))}Ga.prototype.ec=function(){!0!=this.m&&Ja(this,this.H.clientWidth,this.H.clientHeight)};Ga.prototype.w=function(){!0!=this.m&&(this.m=!0,this.N.reset(),this.ba.reset(),this.nb.reset(),null!=this.Aa&&this.Aa.w(),null!=this.Ba&&this.Ba.w(),null!=this.Ja&&this.Ja.w(),null!=this.pa&&this.pa.w(),this.H.removeChild(this.q.A))}; function Ha(a){var b=new T,c=t.ia;c--;for(var d=0;d<c;d++)for(var e=0;e<c;e++){var g=e/c,h=(e+1)/c,k=d/c,l=(d+1)/c;b.o.push(g,k,0);b.o.push(h,k,0);b.o.push(h,l,0);b.s.push(g,k);b.s.push(h,k);b.s.push(h,l);b.o.push(h,l,0);b.o.push(g,l,0);b.o.push(g,k,0);b.s.push(h,l);b.s.push(g,l);b.s.push(g,k)}b.h.f[0]=b.h.f[1]=b.h.f[2]=0;b.h.i[0]=b.h.i[1]=b.h.i[2]=1;b.P=8*(b.o.length+b.s.length)+56;a.Aa=new P(a.q,b);b=new Uint8Array(16384);for(c=0;64>c;c++)for(d=0;64>d;d++)e=4*(64*c+d),1>c||63<=c||1>d||63<=d?(b[e]= 255,b[e+1]=255,b[e+2]=255):(b[e]=32,b[e+1]=32,b[e+2]=32),b[e+3]=255;a.Ba=new S(a.q);a=a.Ba;d=!0;c=a.e;a.S=c.createTexture();c.bindTexture(c.TEXTURE_2D,a.S);d=!0==d?c.REPEAT:c.CLAMP_TO_EDGE;c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,d);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,d);d=!1;switch("trilinear"){case "linear":c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR);break;case "trilinear":c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER, c.LINEAR_MIPMAP_LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR);d=!0;break;default:c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST)}c.pixelStorei(c.UNPACK_ALIGNMENT,1);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,64,64,0,c.RGBA,c.UNSIGNED_BYTE,b);!0==d&&c.generateMipmap(c.TEXTURE_2D);c.bindTexture(c.TEXTURE_2D,null);a.P=16384;a.rb=!0} function Ia(a){for(var b=new T,c=0;32>c;c++)for(var d=0;64>d;d++){var e=b,g=d/64,h=c/32,k=(d+1)/64,l=(c+1)/32,m=t.cb(g,h),n=[g,h],p=t.cb(g,l),g=[g,l],q=t.cb(k,h),h=[k,h],r=t.cb(k,l),k=[k,l];e.o.push(p[0],p[1],p[2]);e.o.push(m[0],m[1],m[2]);e.o.push(q[0],q[1],q[2]);e.s.push(g[0],g[1]);e.s.push(n[0],n[1]);e.s.push(h[0],h[1]);e.o.push(q[0],q[1],q[2]);e.o.push(r[0],r[1],r[2]);e.o.push(p[0],p[1],p[2]);e.s.push(h[0],h[1]);e.s.push(k[0],k[1]);e.s.push(g[0],g[1]);e.P=8*(e.o.length+e.s.length)+56}b.h.f[0]= b.h.f[1]=b.h.f[2]=0;b.h.i[0]=b.h.i[1]=b.h.i[2]=1;a.Ja=new P(a.q,b);a.pa=new S(a.q,a.b.l.pa,a.b)}function Ja(a,b,c){var d=a.k;d.Gb=b/c;d.B=!0;a.G=[b,c];a.q.resize(a.G);Ka(a)}function La(a,b){var c=Math.log(0.05)/(10*a.b.l.ib*(Math.max(5,-a.g[1])/90));ya(b,"uFogDensity",c)} function Ma(a,b,c,d){null==a.wa[b.j]?a.wa[b.j]=1:a.wa[b.j]++;if(c&&!a.Cc)a.Za+=c.sb,a.Ya+=c.ob,d=a.nb.get(b,c),a.q.useProgram(a.va,"aPosition","aTexCoord"),b=a.Nb,t.a.multiply(ra(a.k),c.za(a.c,a.xc),b),c=sa(a.k),R(a.va,"uMV",b),R(a.va,"uProj",c),La(a,a.va),a.q.bindTexture(d.S),xa(d.I,a.va),a.yb++,a.fa+=d.I.wb;else{a.q.useProgram(a.R,"aPosition","aTexCoord");b=a.Nb;t.a.multiply(ra(a.k),d.za(a.c,a.Mb),b);R(a.R,"uMV",b);R(a.R,"uProj",sa(a.k));c=a.Mb;d.za(ia(a.b.n,a.c,a.wc),c);R(a.R,"uGridMat",c);La(a, a.R);c=a.b.l.Rb;b=a.b.l.Sb;var e=t.ia,e=Math.log(a.k.c[2]-0.25*(d.Q[0]+d.Q[e-1]+d.Q[(e-1)*e]+d.Q[(e-1)*e+e-1])+20)/Math.log(c),g=Math.pow(c,Math.ceil(e)),h=e-Math.floor(e);ya(a.R,"uGridStep1",b/Math.pow(c,Math.floor(e)));ya(a.R,"uGridStep2",b/g);ya(a.R,"uGridBlend",h);c=a.R;d=d.Q;b=c.e;null!=b&&null!=c.W&&(c=c.getUniform("uHeight"),null!=c&&b.uniform1fv(c,d));a.q.bindTexture(a.Ba);xa(a.Aa,a.R);a.xb++;a.fa+=a.Aa.wb}} function Na(a){var b=t.a.create();t.a.multiply(t.ab(2,2,2),t.qa(-0.5,-0.5,-0.5),b);var c=t.a.create();t.a.multiply(t.qa(a.k.sa()[0],a.k.sa()[1],a.k.sa()[2]-400),t.Rc(0.9*a.k.ya),c);var d=t.a.create();t.a.multiply(ta(a.k),c,d);t.a.multiply(d,b,d);a.q.useProgram(a.Fa,"aPosition","aTexCoord");a.q.bindTexture(a.pa);wa(a.Fa);R(a.Fa,"uMVP",d);xa(a.Ja,a.Fa);a.fa+=a.Ja.wb} function Oa(a,b){for(var c=b.za(a.c,a.Nc),d=a.G[0]/2,e=0,g=t.ia,h=t.ia-1,k=0;1>=k;k++)for(var l=0;1>=l;l++){var m=[];t.a.Ua(c,[l,k,b.Q[k*h*g+l*h]],m);var n=a.k;n.B&&n.update();t.a.Ua(n.Z,m,n.kc);m=t.J.length(n.kc);n=(m<n.tb?Number.POSITIVE_INFINITY:n.Xa[0]/m)*b.ua[k][l]*d;n>e&&(e=n)}return e} function Pa(a,b){var c=a.N.get(b);if(!c||!ua(a.k,la(c.h,a.c)))return 0;if(!(1E6>c.ua[0][0]))return Qa(a,b,c);var d=Oa(a,c);if(!c.T||d<t.zb*a.Fc){var e=a.ba.get(b),g;if(!(g=e)){a:if(c.T){for(g=0;4>g;g++)if(c.T&1<<g&&!a.ba.contains(N(b,g))){g=!1;break a}g=!0}else g=!1;g=!g}g?Ma(a,b,e,c):Qa(a,b,c);return d}if(d=2.2>d)a:{if(a.ba.contains(b)&&1E6>c.ua[0][0])for(d=0;4>d;d++)if(c.T&1<<d&&(g=N(b,d),e=a.ba.get(g),g=a.N.get(g),!e||!g)){d=!0;break a}d=!1}return d?(e=a.ba.get(b),Ma(a,b,e,c),0):Qa(a,b,c)} function Qa(a,b,c){var d=a.Pc,e;e=c.h;var g=a.Qc;null!=g?(g[0]=0.5*(e.f[0]+e.i[0]),g[1]=0.5*(e.f[1]+e.i[1]),e=g):e=[0.5*(e.f[0]+e.i[0]),0.5*(e.f[1]+e.i[1]),0.5*(e.f[2]+e.i[2])];g=a.k.c;e=Math.floor((Math.atan2(a.c[1]+g[1]-e[1],a.c[0]+g[0]-e[0])+Math.PI)/Math.PI*4);e=t.ja(e,0,7);for(var h=g=0;4>h;h++){var k=d[e][h];c.T&1<<k&&(g=Math.max(g,Pa(a,N(b,k))))}return g} function Ra(a,b){var c=a.N.get(b);if(!c||!ua(a.k,la(c.h,a.c)))return 0;if(1E6>c.ua[0][0]){var d=Oa(a,c);if(!c.T||d<t.zb)return d}for(var e=d=0;4>e;e++)c.T&1<<e&&(d=Math.max(d,Ra(a,N(b,e))));return d} function U(a){switch(a.b.l.da){case "observer":a.g[1]=t.ja(a.g[1],-90,10);a.c[2]=t.ja(a.c[2],5,a.k.ya);t.a.multiply(t.Ga(2,t.ea(a.g[0])),t.Ga(0,t.ea(a.g[1])),a.pc);var b=[0,-a.c[2],0];t.a.Ua(a.pc,b);b[2]+=t.Ma(a.b,a.c,a.N)[0];a.k.Ia(b);a.k.Ha(a.g);break;case "drone":a.g[1]=t.ja(a.g[1],-90,90);a.c[2]=t.ja(a.c[2],5,a.k.ya);b=a.k.c;a.k.Ia([0,0,a.c[2]+t.Ma(a.b,[a.c[0]+b[0],a.c[1]+b[1]],a.N)[0]]);a.k.Ha(a.g);break;case "manual":a.k.Ia([0,0,a.c[2]]),a.k.Ha(a.g)}a.B=!0} function V(a){var b=a.k.c;return a.k.sa()[2]-t.Ma(a.b,[a.c[0]+b[0],a.c[1]+b[1]],a.N)[0]} function Sa(a,b){var c=!1;if("manual"==a.b.l.da)return!1;var d=1E3;if(!0==a.Yb){var e=20,e=Math.max(20,0.1*a.c[2]);if(a.Na||-10<a.g[1]){var g=function(a,b,c){var d=0.5*(a+b);if(20<c)return d;this.g[1]=d;U(this);return V(this)<e?g(a,d,c+1):g(d,b,c+1)}.bind(a);V(a)<e&&(c=!0,a.g[1]=g(-89,Math.min(-1,a.g[1]),0),U(a))}else for(;V(a)<e&&0<d;)c=!0,a.c[2]+=0.01,U(a),d--;return!1}for(;(b>t.zb||0>V(a))&&0<d;){c=!0;if("observer"==a.b.l.da)if(a.Na||-10<a.g[1])250>a.c[2]?a.c[2]+=0.3:a.g[1]-=0.3;else{var h=t.ea(a.g[0]), k=t.ea(-a.g[1]),l=0.5/Math.sin(k),k=l*Math.cos(k),h=[-Math.sin(h),Math.cos(h),0];a.c[0]+=k*h[0];a.c[1]+=k*h[1];a.c[2]+=l}else a.c[2]+=0.5;U(a);b=Ra(a,a.b.n.u);d--}return c}function Ka(a){if("drone"==a.b.l.da&&!a.Tb){var b=t.Ma(a.b,a.c,a.N);if(!b[1])return;a.c[2]+=b[0];a.Tb=!0}b=0;if(!0==a.Yb)Sa(a,b),a.q.clear(),U(a),Pa(a,a.b.n.u),Na(a);else{do a.q.clear(),U(a),b=Pa(a,a.b.n.u),Na(a);while(Sa(a,b))}a.N.trim(a.b.l.hb/10);a.ba.trim(a.b.l.hb);a.Na=!1} Ga.prototype.update=function(){if(!0!=this.m){if(null==this.H||"hidden"!=this.H.style.visibility){this.G[0]==this.H.clientWidth&&this.G[1]==this.H.clientHeight||this.ec();null!=this.fc&&this.fc();this.N.update();this.ba.update();if(!0==this.qc&&(this.fa=this.xb=this.yb=0,this.wa=[],this.Ya=this.Za=0,this.La++,10<=this.La)){var a=Date.now();null!=this.qb&&(this.lb=0.5*(1E3/(a-this.qb)*this.La+this.lb));this.qb=a}a=performance.now();!0==this.B&&Ka(this);if(!0==this.qc&&(this.eb++,this.$a+=performance.now()- a,100<=this.eb&&(this.ic=this.$a/this.eb,this.eb=this.$a=0),null!=this.lc&&10<=this.La&&(this.La=0,!0==this.B))){text_="Redered tiles: "+(this.yb+this.xb)+"<br/>Tile cache: "+Math.round(this.ba.size()/1048576)+"MB<br/>Metatile cache: "+Math.round(this.N.size()/1048576)+"MB<br/>GPU cache: "+Math.round(this.nb.size()/1048576)+"MB<br/>Polygons: "+this.fa+"<br/>Render time: "+Math.round(1E3*this.ic)+"<br/>FPS: "+Math.round(this.lb)+"<br/>Texture files size: "+Math.round(this.Ya/1048576)+"MB<br/>Mesh files size: "+ Math.round(this.Za/1048576)+"MB<br/>LODs tiles:<br/>";for(var b in this.wa)text_+="LOD"+b+": "+this.wa[b]+"<br/>";this.lc.innerHTML=text_}this.B=!1}window.jc(this.update.bind(this))}};function Ta(a,b,c,d){this.b=a;this.v=b;this.I=c;this.F=d;this.P=this.I.size()+d.naturalWidth*d.naturalHeight*3;this.sb=c.fileSize();this.ob=d.naturalWidth*d.naturalHeight*3}Ta.prototype.w=function(){null!=this.I&&(this.I.w(),this.I=null);this.F=null}; Ta.prototype.za=function(a,b){var c=I(this.b.n,this.v.j),d=c/2+this.v.p-a[0],c=c/2+this.v.r-a[1],e=this.I.h,g=b;null!=g?(g[0]=M(e,0),g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=M(e,1),g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=M(e,2),g[11]=0,g[12]=e.f[0]+d,g[13]=e.f[1]+c,g[14]=e.f[2],g[15]=1):(g=t.a.create(),t.a.multiply(t.qa(e.f[0]+d,e.f[1]+c,e.f[2]),t.ab(M(e,0),M(e,1),M(e,2)),g));return g};Ta.prototype.size=function(){return this.P};t.sc=pa; t.tc=function(a,b,c,d){this.b=a;this.v=b;this.Ea=c;this.Da=d;this.jb=this.Vb=this.Zb=!1;this.Oa=function(){!0==this.jb?null!=this.Da&&this.Da(this.v):!0==this.Zb&&!0==this.Vb&&null!=this.Ea&&this.Ea(this.v,new Ta(this.b,this.v,this.I,this.F))}.bind(this);this.F=new Image;this.F.onload=function(){!0!=this.b.m&&(this.Vb=!0,this.Oa())}.bind(this);this.F.onerror=function(){!0!=this.b.m&&(this.jb=!0,this.Oa())}.bind(this);this.F.crossOrigin="anonymous";this.F.src=ha(this.b.n,this.v);this.I=new T;this.Kc= function(){!0!=this.b.m&&(this.Zb=!0,this.Oa())}.bind(this);this.Jc=function(){!0!=this.b.m&&(this.jb=!0,this.Oa())}.bind(this);this.I.load(fa(this.b.n,this.v),this.Kc,this.Jc)};function u(a,b,c,d){this.b=a;this.j=null!=b?b:0;this.p=null!=c?c:0;this.r=null!=d?d:0}function N(a,b){var c=I(a.b.n,a.j),d=a.p+c/2,c=a.r+c/2;switch(b){case 0:return new u(a.b,a.j+1,a.p,a.r);case 1:return new u(a.b,a.j+1,d,a.r);case 2:return new u(a.b,a.j+1,a.p,c);case 3:return new u(a.b,a.j+1,d,c)}} u.prototype.parent=function(){var a=I(this.b.n,this.j),b=this.b.n.u;return new u(this.b,this.j-1,b.p+((this.p-b.p)/a&-2)*a,b.r+((this.r-b.r)/a&-2)*a)};u.prototype.isEqual=function(a){return this.j==a.j&&this.p==a.p&&this.r==a.r}; function W(a,b,c,d,e){if(null!=b&&""!=b){this.M=[];this.C=[];this.U=[];this.Cb=this.l=this.n=this.d=null;this.m=!1;this.H=null;var g="";"string"===typeof b&&(g=b.split("?")[0].split("/").slice(0,-1).join("/")+"/");"string"===typeof a?this.H=document.getElementById(a):"object"===typeof a&&(this.H=a);if(null==this.H)null!=d&&d(!1,"DOM element does not exist");else{var h=null,k=null,l=function(){null==h||null==k&&null!=c||(this.n=new ca(this,h,g),this.l=new ja(k),this.Cb=e,this.d=new Ga(this,this.H, this.Lc.bind(this)),null!=d&&d(!0))}.bind(this);a=function(a){h=a;l()}.bind(this);var m=function(a){k=a;l()}.bind(this),n=function(a){null!=d&&d(!1,a+" config not found")}.bind(this);null!=c&&"string"===typeof c&&t.Xb(c,m,n.bind(this,"browser"));"string"===typeof b&&t.Xb(b,a,n.bind(this,"map"));"object"===typeof b&&(h=b);"object"===typeof c&&(k=c);null==h&&null==k||l()}}}f=W.prototype;f.w=function(){this.d.w();this.m=!0}; f.bb=function(a){if(!0!=this.m&&null!=this.d&&null!=this.d.k&&this.l.da!=a){if("manual"==a){var b;b=!0!=t.m&&null!=t.d?t.Ma(t.b,[this.d.c[0],this.d.c[1]],t.d.N):void 0;b[0]>this.d.c[2]&&(this.d.c[2]=b[0]+100)}this.l.da=a;U(this.d);this.M=[];this.U=[];this.C=[]}};f.Pb=function(){return this.l.da};f.Ia=function(a,b,c){!0!=this.m&&null!=this.d&&(this.d.c=[a,b,c],U(this.d))};f.sa=function(){return!0==this.m||null==this.d?[0,0,0]:[this.d.c[0],this.d.c[1],this.d.c[2]]}; f.Ha=function(a,b,c){!0!=this.m&&null!=this.d&&(this.d.g=[a,b,c],U(this.d))};f.mb=function(){return!0==this.m||null==this.d?[0,0,0]:this.d.g};f.Sc=function(a,b){if(null!=this.d&&null!=this.d.k){var c=this.d.k;c.Ob=a;c.tb=20;c.ya=b;c.B=!0;U(this.d)}};f.Ec=function(){return[0,0,0]};f.Oc=function(){return[0,0,0]};f.ad=function(){return[[0,0],[1,0],[0,1]]}; f.hc=function(a,b){if(!0!=this.m&&null!=this.d){var c=V(this.d)/800;a*=c;b*=c;var d=t.ea(this.mb()[0]),c=[-Math.sin(d),Math.cos(d)],d=[Math.cos(d),Math.sin(d)];this.d.c[0]+=c[0]*b-d[0]*a;this.d.c[1]+=c[1]*b-d[1]*a;0<this.l.ka[0]&&this.M.push([c[0]*b-d[0]*a,c[1]*b-d[1]*a]);U(this.d)}};f.rotate=function(a,b,c){!0!=this.m&&null!=this.d&&(null==c&&(c=0),this.d.g[0]+=0.3*-a,this.d.g[1]+=0.3*-b,this.d.g[2]+=0.3*c,0<this.l.ka[1]&&this.C.push([0.3*-a,0.3*-b,0.3*c]),this.d.Na=!0,U(this.d))}; f.zoom=function(a){!0!=this.m&&null!=this.d&&(a=1+0.001*a,this.d.c[2]*=a,0<this.l.ka[2]&&this.U.push([a]),U(this.d))}; f.Lc=function(){if(!0!=this.m&&null!=this.d){var a=!1,b=this.l.ka[0],c=this.l.ka[1],d=this.l.ka[2];0<this.C.length&&0==this.M.length&&0==this.U.length&&(this.d.Na=!0);for(var e=0;e<this.M.length;e++)this.M[e][0]*=b,this.M[e][1]*=b,this.d.c[0]+=this.M[e][0],this.d.c[1]+=this.M[e][1],0.01>Math.abs(this.M[e][0])+Math.abs(this.M[e][1])&&(this.M.splice(e,1),e--),a=!0;for(e=0;e<this.U.length;e++)this.U[e][0]+=(1-this.U[e][0])*(1-d),this.d.c[2]*=this.U[e][0],this.d.c[2]=Math.min(this.d.c[2],4E5),0.001>Math.abs(1- this.U[e][0])&&(this.U.splice(e,1),e--),a=!0;for(e=0;e<this.C.length;e++)this.C[e][0]*=c,this.C[e][1]*=c,this.C[e][2]*=c,this.d.g[0]+=this.C[e][0],this.d.g[1]+=this.C[e][1],this.d.g[2]+=this.C[e][2],0.01>Math.abs(this.C[e][0])+Math.abs(this.C[e][1])+Math.abs(this.C[e][2])&&(this.C.splice(e,1),e--),a=!0;!0==a&&U(this.d);null!=this.Cb&&this.Cb()}}; t.Ib=function(){var a=document.createElement("canvas");if(null==a)return!1;a.width=1024;a.height=768;if(null==a.getContext)return!1;var b=null;try{b=a.getContext("webgl")||a.getContext("experimental-webgl")}catch(c){return!1}return b?!0:!1};t.Browser=W;W.prototype.setControlMode=W.prototype.bb;W.prototype.getControlMode=W.prototype.Pb;W.prototype.setPosition=W.prototype.Ia;W.prototype.getPosition=W.prototype.sa;W.prototype.setOrientation=W.prototype.Ha;W.prototype.getOrientation=W.prototype.mb; W.prototype.setCamera=W.prototype.Sc;W.prototype.hitTest=W.prototype.Ec;W.prototype.project=W.prototype.Oc;W.prototype.visibleArea=W.prototype.ad;W.prototype.pan=W.prototype.hc;W.prototype.rotate=W.prototype.rotate;W.prototype.zoom=W.prototype.zoom;W.prototype.kill=W.prototype.w;t.checkSupport=t.Ib;var X=null;function Ua(a,b){!1==a&&alert("Vadstena3D initialization failed. Reason: "+b)}var Y=!1,Z=!1,$=!1,Va=!1,Wa=!1,Xa=0,Ya=0,Za=0,$a=0; function ab(a){var b=!1;a=a||window.event;a.which?b=3==a.which:a.button&&(b=2==a.button);!0==b?Va=!0:Wa=!0;Y=a.altKey;Z=a.ctrlKey;$=a.shiftKey}function bb(a){var b=!1;a=a||window.event;a.which?b=3==a.which:a.button&&(b=2==a.button);!0==b?Va=!1:Wa=!1}function cb(a){var b=a.clientX;a=a.clientY;Za=b-Xa;$a=a-Ya;Xa=b;Ya=a;!0==Wa&&!0!=Y&&!0!=Z&&!0!=$&&X.hc(0.5*Za,0.5*$a);!0!=Va&&(!0!=Wa||!0!=Y&&!0!=Z&&!0!=$)||X.rotate(0.4*Za,0.4*$a)} function db(a){a.preventDefault&&a.preventDefault();a.returnValue=!1;var b=0,b=a.wheelDelta,b=(a=a.detail)?b?b/a/40*(0<=a?1:-1):-a/3:b/120;!0==isNaN(b)&&(b=0);b=0>b?1:-1;"observer"==X.Pb()?X.zoom(17.5*b):X.zoom(7*b)}function eb(a){"undefined"==typeof a&&(a=window.event);Y=a.altKey;Z=a.ctrlKey;$=a.shiftKey} function fb(a){"undefined"==typeof a&&(a=window.event);if(a)switch(window.event?window.event.keyCode:a.which?a.which:a.charCode){case 49:X.bb("manual");break;case 50:X.bb("drone");break;case 51:X.bb("observer")}Y=a.altKey;Z=a.ctrlKey;$=a.shiftKey} window.startDemo=function(){!1==t.Ib()?alert("Unfturtunately, Melown Maps need browser support for WebGL. Sorry."):(X=new W("demo","./mapConfig.json",null,Ua),document.onmousedown=ab,document.oncontextmenu=function(){return!1},document.onmouseup=bb,document.onmousemove=cb,window.addEventListener("DOMMouseScroll",db,!0),window.addEventListener("mousewheel",db,!0),document.onselectstart=function(){return!1},document.onkeyup=fb,document.onkeydown=eb)};</script>
</head>
<body style = "padding: 0; margin: 0;" onload="startDemo()">
<div id="demo" style="width:100%; height:100%;"></div>
<div style="position:fixed;left:5px;bottom:5px; width:185; height: 80px; background-color: rgba(250,250,250,0.95); border-radius: 5px;">
<a href="https://www.melown.com/maps/"><img style="padding-left:18px;padding-top:14px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJgAAAA3CAYAAADwiIMaAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2tpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowMDgwMTE3NDA3MjA2ODExODNEMUY3QUI5MDk4Njc3RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3OTI3MTM5NEJBMzkxMUUzOEM4MkE2ODY0RjgzODcwQyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3OTI3MTM5M0JBMzkxMUUzOEM4MkE2ODY0RjgzODcwQyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoyN2Y5YmRiOS0yNTIyLTQwMmQtODM3NC0yNTE4MDUxMGM5OGYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDA4MDExNzQwNzIwNjgxMTgzRDFGN0FCOTA5ODY3N0QiLz4gPC9yZGY6RGVz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" /></a>
</div>
</body>
</html>